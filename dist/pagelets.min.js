!function(){"use strict";class e{static get xhrClass(){return e._XHR||XMLHttpRequest}static set xhrClass(t){e._XHR=t}static get GET(){return"get"}static get POST(){return"post"}static get PUT(){return"put"}static get DELETE(){return"delete"}constructor(t){this.url=t,this.method=e.GET,this.data={},this.headers={},this.responseType=null,this.eventCallback=null,this._xhr=null}setUrl(e){return this.url=e,this}setMethod(e){return this.method=e,this}setData(e){return this.data=e,this}setHeaders(e){return this.headers=e,this}setResponseType(e){return this.responseType=e,this}setEventCallback(e){return this.eventCallback=e,this}send(){const t=this;return new Promise((r,n)=>{const a=this._xhr=new e.xhrClass;let s;if(this.eventCallback&&(a.addEventListener("loadstart",this.eventCallback),a.addEventListener("load",this.eventCallback),a.addEventListener("loadend",this.eventCallback),a.addEventListener("progress",this.eventCallback),a.addEventListener("error",this.eventCallback),a.addEventListener("abort",this.eventCallback)),a.addEventListener("load",()=>{t._xhr=null,r(a)}),a.addEventListener("error",()=>{t._xhr=null,n(a)}),a.addEventListener("abort",()=>{t._xhr=null,n(a)}),this.responseType&&(a.responseType=this.responseType),"object"!=typeof this.data||this.data instanceof FormData)s=this.data;else{s=new FormData;for(let e in this.data)this.data.hasOwnProperty(e)&&s.append(e,this.data[e])}if(a.open(this.method,this.url,!0),this.headers)for(let e in this.headers)this.headers.hasOwnProperty(e)&&a.setRequestHeader(e,this.headers[e]);a.send(s)})}abort(){this._xhr&&this._xhr.abort&&this._xhr.abort()}}var t=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){
/*!
   * History API JavaScript Library v4.2.10
   *
   * Support: IE8+, FF3+, Opera 9+, Safari, Chrome and other
   *
   * Copyright 2011-2018, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
   *
   * http://spb-piksel.ru/
   *
   * MIT license:
   *   http://www.opensource.org/licenses/mit-license.php
   *
   * Update: 2018-04-15 13:54
   */
e.exports=function(){var e=("object"==typeof window?window:this)||{};if(!e.history||"emulate"in e.history)return e.history;var t,r,n=e.document,a=n.documentElement,s=e.Object,i=e.JSON,o=e.location,l=e.history,c=l,u=l.pushState,h=l.replaceState,p=(-1===(r=e.navigator.userAgent).indexOf("Android 2.")&&-1===r.indexOf("Android 4.0")||-1===r.indexOf("Mobile Safari")||-1!==r.indexOf("Chrome")||-1!==r.indexOf("Windows Phone"))&&!!u,d="state"in l,f=s.defineProperty,g=M({},"t")?{}:n.createElement("a"),E="",v=e.addEventListener?"addEventListener":(E="on")&&"attachEvent",m=e.removeEventListener?"removeEventListener":"detachEvent",_=e.dispatchEvent?"dispatchEvent":"fireEvent",y=H(e[v]),b=H(e[m]),R=H(e[_]),w={basepath:"/",redirect:0,type:"/",init:0},x=n.createElement("a"),P=o.href,T="",O=1,S=!1,A=0,L={},I={},C=n.title,k={onhashchange:null,onpopstate:null},q=function(t,r){var n=e.history!==l;n&&(e.history=l),t.apply(l,r),n&&(e.history=c)},j={setup:function(e,t,r){w.basepath=(""+(null==e?w.basepath:e)).replace(/(?:^|\/)[^\/]*$/,"/"),w.type=null==t?w.type:t,w.redirect=null==r?w.redirect:!!r},redirect:function(t,r){if(c.setup(r,t),r=w.basepath,e.top==e.self){var n=N(null,!1,!0)._relative,a=o.pathname+o.search;p?(a=a.replace(/([^\/])$/,"$1/"),n!=r&&new RegExp("^"+r+"$","i").test(a)&&o.replace(n)):a!=r&&(a=a.replace(/([^\/])\?/,"$1/?"),new RegExp("^"+r,"i").test(a)&&o.replace(r+"#"+a.replace(new RegExp("^"+r,"i"),w.type)+o.hash))}},pushState:function(e,t,r){var a=n.title;null!=C&&(n.title=C),u&&q(u,arguments),V(e,r),n.title=a,C=t},replaceState:function(e,t,r){var a=n.title;null!=C&&(n.title=C),delete L[o.href],h&&q(h,arguments),V(e,r,!0),n.title=a,C=t},location:{set:function(t){0===A&&(A=1),e.location=t},get:function(){return 0===A&&(A=1),g}},state:{get:function(){return"object"==typeof L[o.href]?i.parse(i.stringify(L[o.href])):void 0!==L[o.href]?L[o.href]:null}}},D={assign:function(e){p||0!==(""+e).indexOf("#")?o.assign(e):V(null,e)},reload:function(e){o.reload(e)},replace:function(e){p||0!==(""+e).indexOf("#")?o.replace(e):V(null,e,!0)},toString:function(){return this.href},origin:{get:function(){return void 0!==t?t:o.origin?o.origin:o.protocol+"//"+o.hostname+(o.port?":"+o.port:"")},set:function(e){t=e}},href:p?null:{get:function(){return N()._href}},protocol:null,host:null,hostname:null,port:null,pathname:p?null:{get:function(){return N()._pathname}},search:p?null:{get:function(){return N()._search}},hash:p?null:{set:function(e){V(null,(""+e).replace(/^(#|)/,"#"),!1,P)},get:function(){return N()._hash}}};function U(){}function N(e,t,r){if(null==e||""===e||t)e=t?e:o.href,p&&!r||(e=e.replace(/^[^#]*/,"")||"#",e=o.protocol.replace(/:.*$|$/,":")+"//"+o.host+w.basepath+e.replace(new RegExp("^#[/]?(?:"+w.type+")?"),""));else{var a=N(),s=n.getElementsByTagName("base")[0];!r&&s&&s.getAttribute("href")&&(s.href=s.href,a=N(s.href,null,!0));var i=a._pathname,l=a._protocol;e=/^(?:\w+\:)?\/\//.test(e=""+e)?0===e.indexOf("/")?l+e:e:l+"//"+a._host+(0===e.indexOf("/")?e:0===e.indexOf("?")?i+e:0===e.indexOf("#")?i+a._search+e:i.replace(/[^\/]+$/g,"")+e)}x.href=e;var c=/(?:([a-zA-Z0-9\-]+\:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/.exec(x.href),u=c[2]+(c[3]?":"+c[3]:""),h=c[4]||"/",d=c[5]||"",f="#"===c[6]?"":c[6]||"",g=h+d+f,E=h.replace(new RegExp("^"+w.basepath,"i"),w.type)+d;return{_href:c[1]+"//"+u+g,_protocol:c[1],_host:u,_hostname:c[2],_port:c[3]||"",_pathname:h,_search:d,_hash:f,_relative:g,_nohash:E,_special:E+f}}function H(t){return t&&e&&e.EventTarget&&"function"==typeof e.EventTarget.prototype.addEventListener&&"function"==typeof t.bind?t.bind(e):t}function M(t,r,n,a){var i=0;n||(n={set:U},i=1);var o=!n.set,l=!n.get,c={configurable:!0,set:function(){o=1},get:function(){l=1}};try{f(t,r,c),t[r]=t[r],f(t,r,n)}catch(e){}if(!(o&&l||(t.__defineGetter__&&(t.__defineGetter__(r,c.get),t.__defineSetter__(r,c.set),t[r]=t[r],n.get&&t.__defineGetter__(r,n.get),n.set&&t.__defineSetter__(r,n.set)),o&&l))){if(i)return!1;if(t===e){try{var u=t[r];t[r]=null}catch(e){}if("execScript"in e)e.execScript("Public "+r,"VBScript"),e.execScript("var "+r+";","JavaScript");else try{f(t,r,{value:U})}catch(e){"onpopstate"===r&&(y("popstate",n=function(){b("popstate",n,!1);var e=t.onpopstate;t.onpopstate=null,setTimeout((function(){t.onpopstate=e}),1)},!1),O=0)}t[r]=u}else try{try{var h=s.create(t);for(var p in f(s.getPrototypeOf(h)===t?h:t,r,n),t)"function"==typeof t[p]&&(h[p]=t[p].bind(t));try{a.call(h,h,t)}catch(e){}t=h}catch(e){f(t.constructor.prototype,r,n)}}catch(e){return!1}}return t}function $(e,t,r){return e=e===D?o:e,(r=r||{}).set=r.set||function(r){e[t]=r},r.get=r.get||function(){return e[t]},r}function G(t,r){var n=(""+("string"==typeof t?t:t.type)).replace(/^on/,""),a=I[n];if(a){if(null==(r="string"==typeof t?r:t).target)for(var s=["target","currentTarget","srcElement","type"];t=s.pop();)r=M(r,t,{get:"type"===t?function(){return n}:function(){return e}});O&&(("popstate"===n?e.onpopstate:e.onhashchange)||U).call(e,r);for(var i=0,o=a.length;i<o;i++)a[i].call(e,r);return!0}return R(t,r)}function B(){var e=n.createEvent?n.createEvent("Event"):n.createEventObject();e.initEvent?e.initEvent("popstate",!1,!1):e.type="popstate",e.state=c.state,G(e)}function V(e,t,r,n){if(p)P=o.href;else{0===A&&(A=2);var a=N(t,2===A&&-1!==(""+t).indexOf("#"));a._relative!==N()._relative&&(P=n,r?o.replace("#"+a._special):o.hash=a._special)}!d&&e&&(L[o.href]=e),S=!1}function z(t){var r=P;if(P=o.href,r){T!==o.href&&B(),t=t||e.event;var n=N(r,!0),a=N();t.oldURL||(t.oldURL=n._href,t.newURL=a._href),n._hash!==a._hash&&G(t)}}function X(e){setTimeout((function(){y("popstate",(function(e){T=o.href,d||(e=M(e,"state",{get:function(){return c.state}})),G(e)}),!1)}),0),!p&&!0!==e&&"location"in c&&(J(g.hash),S&&(S=!1,B()))}function F(t){var r=t||e.event,n=function(e){for(;e;){if("A"===e.nodeName)return e;e=e.parentNode}}(r.target||r.srcElement),a="defaultPrevented"in r?r.defaultPrevented:!1===r.returnValue;if(n&&"A"===n.nodeName&&!a){var s=N(),i=N(n.getAttribute("href",2));s._href.split("#").shift()===i._href.split("#").shift()&&i._hash&&(s._hash!==i._hash&&(g.hash=i._hash),J(i._hash),r.preventDefault?r.preventDefault():r.returnValue=!1)}}function J(t){var r=n.getElementById(t=(t||"").replace(/^#/,""));if(r&&r.id===t&&"A"===r.nodeName){var s=r.getBoundingClientRect();e.scrollTo(a.scrollLeft||0,s.top+(a.scrollTop||0)-(a.clientTop||0))}}return function(){var t=n.getElementsByTagName("script"),r=(t[t.length-1]||{}).src||"";(-1!==r.indexOf("?")?r.split("?").pop():"").replace(/(\w+)(?:=([^&]*))?/g,(function(e,t,r){w[t]=(r||"").replace(/^(0|false)$/,"")})),y(E+"hashchange",z,!1);var a=[D,g,k,e,j,c];d&&delete j.state;for(var s=0;s<a.length;s+=2)for(var l in a[s])if(a[s].hasOwnProperty(l))if("object"!=typeof a[s][l])a[s+1][l]=a[s][l];else{var u=$(a[s],l,a[s][l]);if(!M(a[s+1],l,u,(function(t,r){r===c&&(e.history=c=a[s+1]=t)})))return b(E+"hashchange",z,!1),!1;a[s+1]===e&&(I[l]=I[l.substr(2)]=[])}return c.setup(),w.redirect&&c.redirect(),w.init&&(A=1),!d&&i&&function(){var t;try{(t=e.sessionStorage).setItem("__historyAPI__t","1"),t.removeItem("__historyAPI__t")}catch(e){t={getItem:function(e){var t=n.cookie.split(e+"=");return t.length>1&&t.pop().split(";").shift()||"null"},setItem:function(e,t){var r={};(r[o.href]=c.state)&&(n.cookie=e+"="+i.stringify(r))}}}try{L=i.parse(t.getItem("__historyAPI__"))||{}}catch(e){L={}}y(E+"unload",(function(){t.setItem("__historyAPI__",i.stringify(L))}),!1)}(),p||n[v](E+"click",F,!1),"complete"===n.readyState?X(!0):(p||N()._relative===w.basepath||(S=!0),y(E+"load",X,!1)),!0}()?(c.emulate=!p,e[v]=function(e,t,r){e in I?I[e].push(t):arguments.length>3?y(e,t,r,arguments[3]):y(e,t,r)},e[m]=function(e,t,r){var n=I[e];if(n){for(var a=n.length;a--;)if(n[a]===t){n.splice(a,1);break}}else b(e,t,r)},e[_]=G,c):void 0}()}));function r(e){return e.filter((function(e){return!document.querySelector('script[src="'+e+'"]')}))}function n(e){return new Promise((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.setAttribute("type","text/javascript"),n.addEventListener("load",t),n.addEventListener("error",r),document.getElementsByTagName("head")[0].appendChild(n)})}function a(e){return o(e,r,n)}function s(e){return e.filter((function(e){return!document.querySelector('link[rel="stylesheet"][href="'+e+'"]')}))}function i(e){return new Promise((t,r)=>{const n=document.createElement("link");n.setAttribute("href",e),n.setAttribute("rel","stylesheet"),n.addEventListener("load",t),n.addEventListener("error",r),document.getElementsByTagName("head")[0].appendChild(n)})}function o(e,t,r){return new Promise((n,a)=>{if((e=t(e)).length<=0)return void n();const s=e.length;let i=0;for(let t=0;t<e.length;t++)r(e[t]).then(()=>{i++,i>=s&&n()}).catch(a)})}const l=t.location||window.location,c={PREPARE:"prepare",PROGRESS:"progress",REQUESTED:"requested",RETRIEVED:"retrieved",RENDERED:"rendered",COMPLETE:"complete",CANCELLED:"cancelled",ERROR:"error"},u="",h="requested",p="loading",d="loaded",f="refreshing",g="error",E={selector:"a[data-uri],button[data-uri],[href][data-target]",allowPersistentTargets:!0,listenElement:document,minRefreshRate:500};class v extends EventTarget{constructor(e){super(),Object.assign(this,e)}get getResolvedTarget(){if(this.targetElement instanceof Element)return this.targetElement;const e=this.targetElement||_.defaultTarget,t=e&&"#"+e||"body";return _.listenElement.querySelector(t)}get getPushUrl(){return this.pushUrl||this.sourceElement&&this.sourceElement.getAttribute("href")||null}triggerEvent(e,t){const r=new CustomEvent(e,{detail:Object.assign({},t,{request:this}),bubbles:!0,cancelable:!0});return(this.triggerOnRequest?this:_.listenElement).dispatchEvent(r)}}class m{constructor(e){Object.assign(this,e)}}let _=Object.assign({},E),y=!1;function b(){return"complete"===document.readyState&&(O(_.listenElement.querySelector(_.defaultTarget&&"#"+_.defaultTarget||"body"),window.location.toString(),window.location.toString(),!0),_.listenElement.addEventListener("click",e=>{if(e.target instanceof Element){const t=e.target.closest(_.selector);t&&(e.preventDefault(),R(new v({url:t.getAttribute("data-uri")||t.getAttribute("href"),pushUrl:t.getAttribute("href"),sourceElement:t,targetElement:t.getAttribute("data-target")})))}}),w(),!0)}function R(t){return t instanceof v||(t=new v(t)),new Promise(r=>{const n=t.getResolvedTarget;P(n,h),n.pageletRequest&&n.pageletRequest.abort();const E=n.getAttribute("id")||"";if(t.triggerEvent(c.PREPARE)){if(!t.url||t.url.match(/^#/))return P(n,g),void t.triggerEvent(c.ERROR,{error:"invalid url"});const h=n.pageletRequest=new e;h.setUrl(t.url).setMethod(t.method||(t.data?e.POST:e.GET)).setHeaders({"x-requested-with":"XMLHttpRequest","x-pagelet-request":"1","x-pagelet-target":E}).setEventCallback(e=>{switch(e.type){case"loadstart":P(n,n.getAttribute("data-self-uri")===t.url?f:p);break;case"progress":t.triggerEvent(c.PROGRESS);break;case"abort":P(n,u),t.triggerEvent(c.CANCELLED);break;case"error":P(n,g),t.triggerEvent(c.ERROR)}}).setData(t.data),h.send().then(e=>{P(n,d);const u=function(e){const t=e.getResponseHeader("content-type");let[r]=t.split(";");const n=e.responseText.replace(/^while\(1\);|for\(;;\);|\)]}'/,"");switch(r){case"":case"text/plain":case"text/html":return new m({content:n});case"application/json":case"application/javascript":return new m(JSON.parse(n));default:throw"not a valid response"}}(e),h={request:t,response:u};t.triggerEvent(c.RETRIEVED,h)&&function(e,t){const r=e.getResolvedTarget;t.hasOwnProperty("content")&&(r.innerHTML=t.content,r.setAttribute("data-self-uri",e.url));t.hasOwnProperty("reloadPagelet")&&Object.keys(t.reloadPagelet).forEach(e=>{const r=t.reloadPagelet[e],n=_.listenElement.querySelector("#"+e);n&&R(new v({url:r||n.getAttribute("data-self-uri"),targetElement:e}))});return Promise.all([(n=t.resources&&t.resources.css||[],o(n,s,i)),a(t.resources&&t.resources.js||[])]).then(()=>{e.triggerEvent(c.RENDERED,{response:t})&&(w(r),function(e){if(e.hasAttribute("data-refresh")){const t=Math.max(_.minRefreshRate,e.getAttribute("data-refresh"));setTimeout(()=>{x(e)},t)}}(r))}).catch(()=>{P(r,g),e.triggerEvent(c.ERROR)});var n}(t,u).then(()=>{if(u.location)u.location.reloadWindow?u.location.replaceHistory?l.replace(u.location.url):l.assign(u.location.url):O(n,u.location.url,t.url,u.location.replaceHistory);else{let e=t.getPushUrl;e&&O(n,e,t.url,!1)}t.triggerEvent(c.COMPLETE,h)}),r(h)}).then(()=>{P(n,u)}),t.triggerEvent(c.REQUESTED)}})}function w(e){(e=e||_.listenElement).querySelectorAll("[data-self-uri]").forEach(e=>{e.pageletInitialized||(e.pageletInitialized=!0,x(e))})}function x(e){R(new v({url:e.getAttribute("data-self-uri"),sourceElement:e,targetElement:e}))}function P(e,t){t?e.setAttribute("data-pagelet-state",t):e.removeAttribute("data-pagelet-state")}const T={};function O(e,r,n,a){if(r&&"#"===r)return;e.pageletId=e.pageletId||function(e){let t="";for(;t.length<e;)t+=parseInt(Math.random().toFixed(16).slice(2,19)).toString(36);return t.slice(0,e)}(36),T[e.pageletId]=e;const s={targetPageletId:e.pageletId,targetId:e.getAttribute("id"),pushUrl:r,ajaxUrl:n};a?t.replaceState(s,null,r):t.pushState(s,null,r)}window.addEventListener("popstate",e=>{const t=e.state;if(t){let e;T[t.targetPageletId]&&_.listenElement.contains(T[t.targetPageletId])?e=T[t.targetPageletId]:_.allowPersistentTargets&&t.targetId&&(e=_.listenElement.querySelector("#"+t.targetId)),e?R(new v({url:t.ajaxUrl,targetElement:e})):l.replace(t.pushUrl)}});var S=Object.freeze({__proto__:null,events:c,Request:v,init:function(e={}){_=Object.assign({},E,e),y||(y=!0,b()||document.addEventListener("readystatechange",b))},load:R});window.Pagelets=S}();
