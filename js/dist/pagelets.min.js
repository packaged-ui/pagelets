!function(){"use strict";class e{get action(){throw"not implemented"}process(e,t,r,n){throw"not implemented"}}var t={exports:{}};
/*!
   * History API JavaScript Library v4.2.10
   *
   * Support: IE8+, FF3+, Opera 9+, Safari, Chrome and other
   *
   * Copyright 2011-2018, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
   *
   * http://spb-piksel.ru/
   *
   * MIT license:
   *   http://www.opensource.org/licenses/mit-license.php
   *
   * Update: 2018-04-15 13:54
   */t.exports=function(){var e=("object"==typeof window?window:this)||{};if(!e.history||"emulate"in e.history)return e.history;var t,r=e.document,n=r.documentElement,s=e.Object,a=e.JSON,o=e.location,i=e.history,l=i,c=i.pushState,u=i.replaceState,h=q(),d="state"in i,p=s.defineProperty,f=H({},"t")?{}:r.createElement("a"),g="",E=e.addEventListener?"addEventListener":(g="on")&&"attachEvent",m=e.removeEventListener?"removeEventListener":"detachEvent",v=e.dispatchEvent?"dispatchEvent":"fireEvent",b=B(e[E]),w=B(e[m]),_=B(e[v]),y={basepath:"/",redirect:0,type:"/",init:0},R="__historyAPI__",x=r.createElement("a"),T=o.href,O="",P=1,L=!1,S=0,A={},C={},k=r.title,j={onhashchange:null,onpopstate:null},I=function(t,r){var n=e.history!==i;n&&(e.history=i),t.apply(i,r),n&&(e.history=l)},D={setup:function(e,t,r){y.basepath=(""+(null==e?y.basepath:e)).replace(/(?:^|\/)[^\/]*$/,"/"),y.type=null==t?y.type:t,y.redirect=null==r?y.redirect:!!r},redirect:function(t,r){if(l.setup(r,t),r=y.basepath,e.top==e.self){var n=M(null,!1,!0)._relative,s=o.pathname+o.search;h?(s=s.replace(/([^\/])$/,"$1/"),n!=r&&new RegExp("^"+r+"$","i").test(s)&&o.replace(n)):s!=r&&(s=s.replace(/([^\/])\?/,"$1/?"),new RegExp("^"+r,"i").test(s)&&o.replace(r+"#"+s.replace(new RegExp("^"+r,"i"),y.type)+o.hash))}},pushState:function(e,t,n){var s=r.title;null!=k&&(r.title=k),c&&I(c,arguments),X(e,n),r.title=s,k=t},replaceState:function(e,t,n){var s=r.title;null!=k&&(r.title=k),delete A[o.href],u&&I(u,arguments),X(e,n,!0),r.title=s,k=t},location:{set:function(t){0===S&&(S=1),e.location=t},get:function(){return 0===S&&(S=1),f}},state:{get:function(){return"object"==typeof A[o.href]?a.parse(a.stringify(A[o.href])):void 0!==A[o.href]?A[o.href]:null}}},U={assign:function(e){h||0!==(""+e).indexOf("#")?o.assign(e):X(null,e)},reload:function(e){o.reload(e)},replace:function(e){h||0!==(""+e).indexOf("#")?o.replace(e):X(null,e,!0)},toString:function(){return this.href},origin:{get:function(){return void 0!==t?t:o.origin?o.origin:o.protocol+"//"+o.hostname+(o.port?":"+o.port:"")},set:function(e){t=e}},href:h?null:{get:function(){return M()._href}},protocol:null,host:null,hostname:null,port:null,pathname:h?null:{get:function(){return M()._pathname}},search:h?null:{get:function(){return M()._search}},hash:h?null:{set:function(e){X(null,(""+e).replace(/^(#|)/,"#"),!1,T)},get:function(){return M()._hash}}};function N(){}function M(e,t,n){var s=/(?:([a-zA-Z0-9\-]+\:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/;if(null==e||""===e||t)e=t?e:o.href,h&&!n||(e=e.replace(/^[^#]*/,"")||"#",e=o.protocol.replace(/:.*$|$/,":")+"//"+o.host+y.basepath+e.replace(new RegExp("^#[/]?(?:"+y.type+")?"),""));else{var a=M(),i=r.getElementsByTagName("base")[0];!n&&i&&i.getAttribute("href")&&(i.href=i.href,a=M(i.href,null,!0));var l=a._pathname,c=a._protocol;e=/^(?:\w+\:)?\/\//.test(e=""+e)?0===e.indexOf("/")?c+e:e:c+"//"+a._host+(0===e.indexOf("/")?e:0===e.indexOf("?")?l+e:0===e.indexOf("#")?l+a._search+e:l.replace(/[^\/]+$/g,"")+e)}x.href=e;var u=s.exec(x.href),d=u[2]+(u[3]?":"+u[3]:""),p=u[4]||"/",f=u[5]||"",g="#"===u[6]?"":u[6]||"",E=p+f+g,m=p.replace(new RegExp("^"+y.basepath,"i"),y.type)+f;return{_href:u[1]+"//"+d+E,_protocol:u[1],_host:d,_hostname:u[2],_port:u[3]||"",_pathname:p,_search:f,_hash:g,_relative:E,_nohash:m,_special:m+g}}function q(){var t=e.navigator.userAgent;return(-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&!!c}function B(t){return t&&e&&e.EventTarget&&"function"==typeof e.EventTarget.prototype.addEventListener&&"function"==typeof t.bind?t.bind(e):t}function G(){var t;try{(t=e.sessionStorage).setItem(R+"t","1"),t.removeItem(R+"t")}catch(e){t={getItem:function(e){var t=r.cookie.split(e+"=");return t.length>1&&t.pop().split(";").shift()||"null"},setItem:function(e,t){var n={};(n[o.href]=l.state)&&(r.cookie=e+"="+a.stringify(n))}}}try{A=a.parse(t.getItem(R))||{}}catch(e){A={}}b(g+"unload",(function(){t.setItem(R,a.stringify(A))}),!1)}function H(t,r,n,a){var o=0;n||(n={set:N},o=1);var i=!n.set,l=!n.get,c={configurable:!0,set:function(){i=1},get:function(){l=1}};try{p(t,r,c),t[r]=t[r],p(t,r,n)}catch(e){}if(!(i&&l||(t.__defineGetter__&&(t.__defineGetter__(r,c.get),t.__defineSetter__(r,c.set),t[r]=t[r],n.get&&t.__defineGetter__(r,n.get),n.set&&t.__defineSetter__(r,n.set)),i&&l))){if(o)return!1;if(t===e){try{var u=t[r];t[r]=null}catch(e){}if("execScript"in e)e.execScript("Public "+r,"VBScript"),e.execScript("var "+r+";","JavaScript");else try{p(t,r,{value:N})}catch(e){"onpopstate"===r&&(b("popstate",n=function(){w("popstate",n,!1);var e=t.onpopstate;t.onpopstate=null,setTimeout((function(){t.onpopstate=e}),1)},!1),P=0)}t[r]=u}else try{try{var h=s.create(t);for(var d in p(s.getPrototypeOf(h)===t?h:t,r,n),t)"function"==typeof t[d]&&(h[d]=t[d].bind(t));try{a.call(h,h,t)}catch(e){}t=h}catch(e){p(t.constructor.prototype,r,n)}}catch(e){return!1}}return t}function $(e,t,r){return e=e===U?o:e,(r=r||{}).set=r.set||function(r){e[t]=r},r.get=r.get||function(){return e[t]},r}function F(e,t,r){e in C?C[e].push(t):arguments.length>3?b(e,t,r,arguments[3]):b(e,t,r)}function z(e,t,r){var n=C[e];if(n){for(var s=n.length;s--;)if(n[s]===t){n.splice(s,1);break}}else w(e,t,r)}function V(t,r){var n=(""+("string"==typeof t?t:t.type)).replace(/^on/,""),s=C[n];if(s){if(null==(r="string"==typeof t?r:t).target)for(var a=["target","currentTarget","srcElement","type"];t=a.pop();)r=H(r,t,{get:"type"===t?function(){return n}:function(){return e}});P&&(("popstate"===n?e.onpopstate:e.onhashchange)||N).call(e,r);for(var o=0,i=s.length;o<i;o++)s[o].call(e,r);return!0}return _(t,r)}function W(){var e=r.createEvent?r.createEvent("Event"):r.createEventObject();e.initEvent?e.initEvent("popstate",!1,!1):e.type="popstate",e.state=l.state,V(e)}function Q(){L&&(L=!1,W())}function X(e,t,r,n){if(h)T=o.href;else{0===S&&(S=2);var s=M(t,2===S&&-1!==(""+t).indexOf("#"));s._relative!==M()._relative&&(T=n,r?o.replace("#"+s._special):o.hash=s._special)}!d&&e&&(A[o.href]=e),L=!1}function J(t){var r=T;if(T=o.href,r){O!==o.href&&W(),t=t||e.event;var n=M(r,!0),s=M();t.oldURL||(t.oldURL=n._href,t.newURL=s._href),n._hash!==s._hash&&V(t)}}function Z(e){setTimeout((function(){b("popstate",(function(e){O=o.href,d||(e=H(e,"state",{get:function(){return l.state}})),V(e)}),!1)}),0),!h&&!0!==e&&"location"in l&&(ee(f.hash),Q())}function K(e){for(;e;){if("A"===e.nodeName)return e;e=e.parentNode}}function Y(t){var r=t||e.event,n=K(r.target||r.srcElement),s="defaultPrevented"in r?r.defaultPrevented:!1===r.returnValue;if(n&&"A"===n.nodeName&&!s){var a=M(),o=M(n.getAttribute("href",2));a._href.split("#").shift()===o._href.split("#").shift()&&o._hash&&(a._hash!==o._hash&&(f.hash=o._hash),ee(o._hash),r.preventDefault?r.preventDefault():r.returnValue=!1)}}function ee(t){var s=r.getElementById(t=(t||"").replace(/^#/,""));if(s&&s.id===t&&"A"===s.nodeName){var a=s.getBoundingClientRect();e.scrollTo(n.scrollLeft||0,a.top+(n.scrollTop||0)-(n.clientTop||0))}}function te(){var t=r.getElementsByTagName("script"),n=(t[t.length-1]||{}).src||"";(-1!==n.indexOf("?")?n.split("?").pop():"").replace(/(\w+)(?:=([^&]*))?/g,(function(e,t,r){y[t]=(r||"").replace(/^(0|false)$/,"")})),b(g+"hashchange",J,!1);var s=[U,f,j,e,D,l];d&&delete D.state;for(var o=0;o<s.length;o+=2)for(var i in s[o])if(s[o].hasOwnProperty(i))if("object"!=typeof s[o][i])s[o+1][i]=s[o][i];else{var c=$(s[o],i,s[o][i]);if(!H(s[o+1],i,c,(function(t,r){r===l&&(e.history=l=s[o+1]=t)})))return w(g+"hashchange",J,!1),!1;s[o+1]===e&&(C[i]=C[i.substr(2)]=[])}return l.setup(),y.redirect&&l.redirect(),y.init&&(S=1),!d&&a&&G(),h||r[E](g+"click",Y,!1),"complete"===r.readyState?Z(!0):(h||M()._relative===y.basepath||(L=!0),b(g+"load",Z,!1)),!0}return te()?(l.emulate=!h,e[E]=F,e[m]=z,e[v]=V,l):void 0}();var r=t.exports;function n(e,t,n,s){if(t&&"#"===t)return;const a=[];let o=e;do{o&&o.matches("[data-self-uri]")&&a.push({targetId:o.getAttribute("id"),url:o.getAttribute("data-self-uri")})}while(o=o.parentElement);const i={paths:a.reverse(),pushUrl:t};s?r.replaceState(i,null,t):r.pushState(i,null,t)}const s=r&&r.location||window.location;class a{get xhr(){return this._xhr}get xhrClass(){return this._xhrClass||a._XHR||XMLHttpRequest}static set xhrClass(e){a._XHR=e}static get GET(){return"get"}static get POST(){return"post"}static get PUT(){return"put"}static get DELETE(){return"delete"}constructor(e,t){this.url=e,this.method=null,this.data=null,this.headers={},this.responseType=null,this.downloadEventCallback=null,this.uploadEventCallback=null,this.withCredentials=null,this._xhr=null,this._xhrClass=t}setUrl(e){return this.url=e,this}setMethod(e){return this.method=e,this}setData(e){return this.data=e,this}setHeaders(e){return this.headers=e,this}setResponseType(e){return this.responseType=e,this}setEventCallback(e,t){return this.downloadEventCallback=e,this.uploadEventCallback=t,this}setWithCredentials(e){return this.withCredentials=e,this}send(e,t){const r=this;return e&&(this.setData(e),this.method||t||(t=a.POST)),void 0!==t&&this.setMethod(t),new Promise(((e,t)=>{const n=this._xhr=new this.xhrClass;this.downloadEventCallback&&(n.addEventListener("loadstart",this.downloadEventCallback),n.addEventListener("load",this.downloadEventCallback),n.addEventListener("loadend",this.downloadEventCallback),n.addEventListener("progress",this.downloadEventCallback),n.addEventListener("error",this.downloadEventCallback),n.addEventListener("abort",this.downloadEventCallback)),this.uploadEventCallback&&(n.upload.addEventListener("loadstart",this.uploadEventCallback),n.upload.addEventListener("load",this.uploadEventCallback),n.upload.addEventListener("loadend",this.uploadEventCallback),n.upload.addEventListener("progress",this.uploadEventCallback),n.upload.addEventListener("error",this.uploadEventCallback),n.upload.addEventListener("abort",this.uploadEventCallback)),n.addEventListener("load",(()=>{r._xhr=null,e(n)})),n.addEventListener("error",(()=>{r._xhr=null,t(new i(n.statusText||"socket closed",n))})),n.addEventListener("abort",(()=>{r._xhr=null,t(new o("aborted",n))})),this.responseType&&(n.responseType=this.responseType);const s=this.method||a.GET;let l,c=new URLSearchParams;if(this.data instanceof FormData?s===a.GET?this.data.forEach(((e,t)=>c.append(t,e))):l=this.data:this.data instanceof URLSearchParams?s===a.GET?c=this.data.toString():l=this.data.toString():this.data&&"object"==typeof this.data?s===a.GET?c=Object.entries(this.data).map((([e,t])=>encodeURIComponent(e)+"="+encodeURIComponent(t))).join("&"):l=Object.entries(this.data).map((([e,t])=>encodeURIComponent(e)+"="+encodeURIComponent(t))).join("&"):void 0!==this.data&&null!==this.data&&(s===a.GET?c=new URLSearchParams(this.data):l=this.data),n.open(s,function(e,t){let r;[e,r]=e.split("?"),r=new URLSearchParams(r),new URLSearchParams(t).forEach(((e,t)=>r.append(t,e))),Array.from(r).length>0&&(e=e+"?"+r.toString());return e}
/*! (c) Andrea Giammarchi - ISC */(this.url,c.toString()),!0),this.withCredentials&&(n.withCredentials=this.withCredentials),this.headers)for(let e in this.headers)this.headers.hasOwnProperty(e)&&n.setRequestHeader(e,this.headers[e]);n.send(l)}))}abort(){this._xhr&&this._xhr.abort&&this._xhr.abort()}}class o extends Error{#e;constructor(e,t){super(e),this.#e=t}}class i extends Error{#e;constructor(e,t){super(e),this.#e=t}}var l={};try{l.EventTarget=(new EventTarget).constructor}catch(e){!function(e,t){var r=e.create,n=e.defineProperty,s=a.prototype;function a(){t.set(this,r(null))}function o(e,t,r){n(e,t,{configurable:!0,writable:!0,value:r})}function i(e){var t=e.options;return t&&t.once&&e.target.removeEventListener(this.type,e.listener),"function"==typeof e.listener?e.listener.call(e.target,this):e.listener.handleEvent(this),this._stopImmediatePropagationFlag}o(s,"addEventListener",(function(e,r,n){for(var s=t.get(this),a=s[e]||(s[e]=[]),o=0,i=a.length;o<i;o++)if(a[o].listener===r)return;a.push({target:this,listener:r,options:n})})),o(s,"dispatchEvent",(function(e){var r=t.get(this)[e.type];return r&&(o(e,"target",this),o(e,"currentTarget",this),r.slice(0).some(i,e),delete e.currentTarget,delete e.target),!0})),o(s,"removeEventListener",(function(e,r){for(var n=t.get(this),s=n[e]||(n[e]=[]),a=0,o=s.length;a<o;a++)if(s[a].listener===r)return void s.splice(a,1)})),l.EventTarget=a}(Object,new WeakMap)}var c=l.EventTarget;class u{constructor(){this._processors=new Map}iterate(e,t,r,n){return(e=e||[]).reduce((async(e,s)=>(r._processedActions=r._processedActions||[],r._processedActions.push(s),n.synchronous&&await e,this._getPromiseForAction(s,t,r,n))),Promise.resolve())}addProcessor(e){this._processors.set(e.action,e)}clone(){const e=new u;return this._processors.forEach((t=>{e.addProcessor(Object.assign(Object.create(Object.getPrototypeOf(t)),t))})),e}_getPromiseForAction(e,t,r,n){const s=this._processors.get(e.action);return s?s.process(e,t,r,n):new Promise((e=>e()))}}const h={uninitialized:0,loading:1,interactive:2,loaded:3,complete:4};class d{_callbacks=new Set;_resolved=!1;subscribe(e){return this._callbacks.add(e),this._resolved&&e(),this}unsubscribe(e){return this._callbacks.delete(e),this}complete(){return this._resolved||(this._resolved=!0,this._callbacks.forEach((e=>e()))),this}}const p=new Map([[h.uninitialized,new d],[h.loading,new d],[h.interactive,new d],[h.loaded,new d],[h.complete,new d]]);let f=-1;function g(e=h.loaded){if("number"!=typeof(e=h[e]||e)||!p.has(e))throw new Error("not a valid state");return p.get(e)}function E(e){(e=h[e]||e)>f&&(f=e,Object.entries(h).forEach((([,t])=>{t<=f&&p.has(e)&&p.get(t).complete()})))}document.addEventListener("readystatechange",(()=>{E(document.readyState)})),document.addEventListener("DOMContentLoaded",(()=>{E(h.loaded)})),E(document.readyState);const m=r&&r.location||window.location,v={PREPARE:"prepare",PROGRESS:"progress",REQUESTED:"requested",RETRIEVED:"retrieved",RENDERED:"rendered",COMPLETE:"complete",CANCELLED:"cancelled",ERROR:"error"},b={NONE:"",REQUESTED:"requested",LOADING:"loading",LOADED:"loaded",REFRESHING:"refreshing",ERROR:"error"},w={selector:"a[data-uri],button[data-uri],[href][data-target]",formSelector:"form[data-uri],form[data-target]",allowPersistentTargets:!0,listenElement:document,minRefreshRate:500,iterator:new u,composedEvents:!1,handlePopState:!0};class _ extends c{constructor(e){super(),e.iterator=e.iterator||R.iterator,Object.assign(this,e)}addProcessor(e){return Object.is(this.iterator,R.iterator)&&(this.iterator=R.iterator.clone()),this.iterator.addProcessor(e),this}get getResolvedTarget(){if(!1===this.targetElement)return null;if(this.targetElement instanceof Element)return this.targetElement;let e=this.targetElement||R.defaultTarget,t=document.body;return e&&R.listenElement.getElementById(e)?t=R.listenElement.getElementById(e)||t:e&&this.sourceElement&&this.sourceElement.getRootNode()instanceof ShadowRoot&&(t=this.sourceElement.getRootNode().getElementById(e)||t),t}get getRequestedTarget(){return"string"==typeof this.targetElement?this.targetElement:this.targetElement instanceof Element?this.targetElement.id:null}getRequestMethod(){return(this.method||"").toLowerCase()||"get"}get getPushUrl(){return!1!==this.pushUrl&&(this.pushUrl||this.sourceElement&&this.sourceElement.getAttribute("href")||null)}triggerEvent(e,t={},r=!1){const n=new CustomEvent(e,{detail:Object.assign({},t,{request:this}),bubbles:!0,cancelable:r,composed:R.composedEvents});return this.dispatchEvent(n)&&(this.sourceElement&&this.sourceElement.isConnected?this.sourceElement:R.listenElement).dispatchEvent(n)}static fromElement(e){const t=new _({url:e.getAttribute("data-uri"),sourceElement:e,targetElement:e.getAttribute("data-target")});return e instanceof HTMLFormElement&&(t.url=t.url||e.getAttribute("action"),t.data=new FormData(e),t.method=e.getAttribute("method").toLowerCase()||void 0,t.pushUrl||"get"!==e.method||(t.pushUrl=e.getAttribute("action")||t.url)),t}}class y{constructor(e){Object.assign(this,e)}}let R=Object.assign({},w),x=!1;function T(){var e;n((e=R.defaultTarget)&&R.listenElement.getElementById(e)||document.body,window.location.toString(),window.location.toString(),!0),R.listenElement.addEventListener("click",(e=>{if(e.target instanceof Element){const t=e.path||e.composedPath();let r=e.target.closest(R.selector);if(null===r&&t&&t.length>0&&t.every((e=>!(e instanceof Element&&e.matches(R.selector))||(r=e,!1))),r){const t=r.getAttribute("href");if(/^data:/.test(t))return;e.preventDefault(),P(new _({url:r.getAttribute("data-uri")||t,pushUrl:t,sourceElement:r,targetElement:r.getAttribute("data-target")}))}}})),R.listenElement.addEventListener("submit",(e=>{const t=e.composedPath()||e.path,r=t&&t[0]||e.target;R.formSelector&&r.matches(R.formSelector)&&(P(_.fromElement(r)).catch((e=>console.log(e))),e.preventDefault())})),L()}const O=new Map;function P(e){return e instanceof _||(e=new _(e)),new Promise(((t,r)=>{if(e.triggerEvent(v.PREPARE,{},!0)){const s=e.getResolvedTarget;if(k(s,b.REQUESTED),!e.url||/^#/.test(e.url)||/^data:/.test(e.url))throw k(s,b.ERROR),e.triggerEvent(v.ERROR,{error:"invalid url"}),"invalid url";A(s),O.has(s)&&(O.get(s).abort(),O.delete(s));const o=new a(e.url);O.set(s,o),o.setWithCredentials(e.withCredentials).setMethod(e.getRequestMethod()).setHeaders(Object.assign({},{"x-requested-with":"XMLHttpRequest","x-pagelet-request":"1","x-pagelet-target":e.getRequestedTarget||"","x-pagelet-fragment":e.url.replace(/^.*?(#|$)/,"")},e.headers||{})).setEventCallback((t=>{switch(t.type){case"loadstart":k(s,s.getAttribute("data-self-uri")===e.url?b.REFRESHING:b.LOADING);break;case"progress":e.triggerEvent(v.PROGRESS);break;case"abort":k(s,b.NONE),e.triggerEvent(v.CANCELLED);break;case"error":k(s,b.ERROR),e.triggerEvent(v.ERROR)}})).setData(e.data);const i={request:e};o.send().then((e=>{k(s,b.LOADED),i.response=function(e){const t=e.getResponseHeader("content-type");let[r]=t&&t.split(";")||[""];const n=e.responseText.replace(/^while\(1\);|for\(;;\);|\)]}'/,""),s={status:e.status,statusText:e.statusText,rawResponse:n,headers:j(e.getAllResponseHeaders())};switch(r){case"":case"text/plain":case"text/html":const e={};return e.actions=[{action:"content",content:n}],new y(Object.assign(e,s));case"application/json":case"application/javascript":return new y(Object.assign(JSON.parse(n),s));default:throw"not a valid response"}}(e)})).then((()=>{if(e.triggerEvent(v.RETRIEVED,i,!0))return function(e,t){const r=e.getResolvedTarget;return e.iterator.iterate(t.actions,e,t,R).then((()=>{e.triggerEvent(v.RENDERED,{response:t},!0)&&(L(r),function(e){if(A(e),document.contains(e)){if(e.hasAttribute("data-refresh")){const t=Math.max(R.minRefreshRate,e.getAttribute("data-refresh"));S.set(e,setTimeout((()=>C(e)),t))}}else S.delete(e)}(r));const s=e.getPushUrl;if(s&&s!==m.href.substr(-s.length)){t._processedActions&&t._processedActions.reduce(((e,t)=>e||"location"===t.action),!1)||n(e.getResolvedTarget,s,e.url,!1)}}))}(e,i.response)})).then((()=>{e.triggerEvent(v.COMPLETE,i),k(s,b.NONE),t(i)})).catch((t=>{k(s,b.ERROR),e.triggerEvent(v.ERROR),r(t)})),e.triggerEvent(v.REQUESTED)}}))}function L(e){(e=e||R.listenElement).querySelectorAll("[data-self-uri]").forEach((e=>{e.pageletInitialized||e.hasAttribute("data-ignore-init")||(e.pageletInitialized=!0,C(e))}))}const S=new WeakMap;function A(e){S.has(e)&&clearTimeout(S.get(e))}function C(e){if(e){const t=e.getAttribute("data-self-uri");t?P(new _({url:t,sourceElement:e,targetElement:e})):L(e)}}function k(e,t){t?e.setAttribute("data-pagelet-state",t):e.removeAttribute("data-pagelet-state")}function j(e){const t={};return e.trim().split(/[\r\n]+/).forEach((e=>{const r=e.split(": "),n=r.shift();t[n]=r.join(": ")})),t}function I(e){R.iterator.addProcessor(e)}function D(e){return e.filter((function(e){return!document.querySelector('script[src="'+e+'"]')}))}function U(e,t={}){return new Promise(((r,n)=>{const s=document.createElement("script");Object.keys(t).forEach((e=>s.setAttribute(e,t[e]))),s.setAttribute("src",e),s.setAttribute("type","text/javascript"),s.addEventListener("load",r),s.addEventListener("error",n),document.getElementsByTagName("head")[0].appendChild(s)}))}function N(e){return e.filter((function(e){return!document.querySelector('link[rel="stylesheet"][href="'+e+'"]')}))}function M(e,t={}){return new Promise(((r,n)=>{const s=document.createElement("link");Object.keys(t).forEach((e=>s.setAttribute(e,t[e]))),s.setAttribute("href",e),s.setAttribute("rel","stylesheet"),s.addEventListener("load",r),s.addEventListener("error",n),document.getElementsByTagName("head")[0].appendChild(s)}))}function q(e,t,r,n){return new Promise(((s,a)=>{if((e=t(e)).length<=0)return void s();const o=e.length;let i=0;for(let t=0;t<e.length;t++)r(e[t],n).then((()=>{i++,i>=o&&s()})).catch(a)}))}I(new class extends e{get action(){return"content"}process(e,t,r,n){return new Promise((r=>{if(!1!==e.target){let r;e.target&&n.listenElement.getElementById(e.target)?r=n.listenElement.getElementById(e.target):(r=t.getResolvedTarget,r&&"get"===t.getRequestMethod()&&r.setAttribute("data-self-uri",t.url)),r?r.innerHTML=e.content:console.warn("content target does not exist",t,e)}r()}))}}),I(new class extends e{get action(){return"location"}process(e,t,r,a){return new Promise((r=>{e.reload?e.replace?s.replace(e.url):s.assign(e.url):n(t.getResolvedTarget,e.url,t.url,e.replace),r()}))}}),I(new class extends e{get action(){return"load"}process(e,t,r,n){return P(new _({url:e.url,targetElement:e.target||t.targetElement}))}}),I(new class extends e{get action(){return"resource"}process(e,t,r,n){switch(e.type){case"css":if(e.inline){const t=function(e,t,r){var n,s,a=void 0===r?2166136261:r;for(n=0,s=e.length;n<s;n++)a^=e.charCodeAt(n),a+=(a<<1)+(a<<4)+(a<<7)+(a<<8)+(a<<24);if(t)return("0000000"+(a>>>0).toString(16)).substr(-8);return a>>>0}(e.data,!0);if(document.querySelector(`[hash="${t}"]`))return;const r=document.createElement("style");r.setAttribute("hash",t),r.type="text/css",r.styleSheet?r.styleSheet.cssText=e.data:r.appendChild(document.createTextNode(e.data)),document.head.append(r);break}return function(e,t){return q(e,N,M,t)}([e.data],e.options);case"js":if(e.inline){new Function(e.data)();break}return function(e,t){return q(e,D,U,t)}([e.data],e.options)}return new Promise((e=>e()))}}),I(new class extends e{get action(){return"refresh"}process(e,t,r,n){return new Promise((r=>{let s;s=e.target?n.listenElement.getElementById(e.target):t.getResolvedTarget,C(s),r()}))}}),I(new class extends e{get action(){return"synchronous"}process(e,t,r,n){return t.iterator.iterate(e.actions,t,r,Object.assign({},n,{synchronous:!0}))}}),I(new class extends e{get action(){return"log"}process(e,t,r,n){return new Promise((t=>{console[e.level]||(e.level="log"),console[e.level](e.message),t()}))}});var B=Object.freeze({__proto__:null,CustomActionProcessor:class extends e{constructor(e,t){super(),this._fn=t,this._action=e}get action(){return this._action}process(e,t,r,n){return new Promise((t=>{this._fn(e),t()}))}},events:v,Request:_,Response:y,init:function(e={}){R=Object.assign({},w,e),x||(x=!0,R.handlePopState&&window.addEventListener("popstate",(e=>function(e){const t=e.state;t&&(t.paths.length>0?t.paths.slice(0).reduce((async(e,{targetId:r,url:n},s,a)=>{await e;const o=R.listenElement.getElementById(r);return o?s===a.length-1||o.getAttribute("data-self-uri")!==n?P(new _({url:n,targetElement:o})):Promise.resolve():(m.replace(t.pushUrl),a.splice(0),Promise.resolve())}),Promise.resolve()):m.replace(t.pushUrl))}(e))),g(h.loaded).subscribe(T),g(h.complete).subscribe(L))},load:P,refresh:C,refreshChildElements:function(e){e&&L(e)},addProcessor:I,getIterator:function(){return R.iterator},clearProcessors:function(){R.iterator=new u},iterateResponse:function(e,t){return R.iterator.iterate(e.actions,t,e,R)}});window.Pagelets=B}();
